<!--
Owing to a limitation in the design of gensrc, The XML definitions of ObjectHandler functions
appear in two places:

1) ObjectHandler\gensrc\metadata\Functions\*.xml
   - Functions for Excel
2) QuantLibAddin\gensrc\metadata\Functions\ohfunctions.xml
   - Functions for non-Excel platforms and documentation
   
This is necessary because on the Excel platform, OH functions must appear in the OH binary,
while on other platforms OH functions must appear in the client binary.

gensrc will be enhanced to better cope with this problem.
-->

<Category name='logging'>
  <description>logging functions</description>
  <displayName>Logging Functions</displayName>
  <xlFunctionWizardCategory>ObjectHandler</xlFunctionWizardCategory>
  <addinIncludes/>

  <copyright>
    Copyright (C) 2004, 2005 Ferdinando Ametrano
    Copyright (C) 2004, 2005, 2006 Eric Ehlers
    Copyright (C) 2005, 2006 Plamen Neykov
    Copyright (C) 2004 StatPro Italia srl
  </copyright>

  <Functions>

    <Procedure name='ohLogAllObjects'>
      <description>write all object descriptions to log file</description>
      <alias>ObjectHandler::logAllObjects</alias>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>void</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Procedure>

    <Procedure name='ohLogMessage'>
      <description>log a message</description>
      <alias>ObjectHandler::logMessage</alias>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='LogMessage'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>message to be logged</description>
          </Parameter>
          <Parameter name='LogLevel' default='4'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>threshold for log messages</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>void</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Procedure>

    <Procedure name='ohLogObject'>
      <description>write object description to log file</description>
      <alias>ObjectHandler::logObject</alias>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ObjectId'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>ID of object to be logged</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>void</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Procedure>

    <Procedure name='ohSetLogFile'>
      <description>begin logging to named file</description>
      <alias>ObjectHandler::setLogFile</alias>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='LogFileName'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>path and name of log file</description>
          </Parameter>
          <Parameter name='LogLevel' default='4'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>threshold for log messages</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>string</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Procedure>

    <Procedure name='ohSetLogLevel'>
      <description>set threshold for log messages</description>
      <alias>ObjectHandler::setLogLevel</alias>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='LogLevel'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>threshold for log messages</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>void</type>
        <tensorRank>scalar</tensorRank>
        <description>returns new logging threshold</description>
      </ReturnValue>
    </Procedure>

  </Functions>

</Category>
