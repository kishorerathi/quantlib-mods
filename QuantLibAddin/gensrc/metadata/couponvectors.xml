<Category name='couponvectors'>
  <description>functions to construct and use Leg objects</description>
  <displayName>Coupon Vectors</displayName>
  <xlFunctionWizardCategory>QuantLib - Financial</xlFunctionWizardCategory>
  <includes>
    <include>qlo/couponvectors.hpp</include>
    <include>qlo/termstructures.hpp</include>
    <include>qlo/swaptionvolstructure.hpp</include>
    <include>qlo/capletvolstructure.hpp</include>
  </includes>
  <copyright>
    Copyright (C) 2006 Ferdinando Ametrano
    Copyright (C) 2006, 2007 Cristina Duminuco
    Copyright (C) 2005 Aurelien Chanudet
  </copyright>

  <Functions>

    <!-- Leg interface -->
    <Member name='qlLegStartDate' objectClass='Leg'>
      <description>Returns the start (i.e. first accrual) date for the given Leg object</description>
      <libraryFunction>startDate</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Date'>
        <type>long</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlLegMaturityDate' objectClass='Leg'>
      <description>Returns the maturity (i.e. last payment) date for the given Leg object</description>
      <libraryFunction>startDate</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Date'>
        <type>long</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlLegNPV' objectClass='Leg'>
      <description>Returns the net present value for the given Leg object</description>
      <libraryFunction>npv</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='YieldCurve' libToHandle='YieldTermStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlLegBPS' objectClass='Leg'>
      <description>Returns the basis point sensitivity for the given Leg object</description>
      <libraryFunction>bps</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='YieldCurve' libToHandle='YieldTermStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlLegAtmRate' objectClass='Leg'>
      <description>Returns the at-the-money rate for the given Leg object, i.e. the fixed rate for which an equivalent vector of fixed-rate cash flows would have the same NPV.</description>
      <libraryFunction>atmRate</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='YieldCurve' libToHandle='YieldTermStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Rate'>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlLegAnalysis' objectClass='Leg'>
      <description>Returns the flow analysis for the given Leg object</description>
      <libraryFunction>analysis</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>any</type>
        <tensorRank>matrix</tensorRank>
      </ReturnValue>
    </Member>

    <!-- Leg constructors -->
    <Constructor name='qlFixedRateLeg'>
      <libraryFunction>FixedRateLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ScheduleID' libraryClass='Schedule'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Schedule object ID</description>
          </Parameter>
          <Parameter name='PaymentAdj' enumeration='QuantLib::BusinessDayConvention' default='"Following"' exampleValue='Following'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Payment Adjustment: business days convention used for payment dates. Default is Following.</description>
          </Parameter>
          <Parameter name='Nominal' exampleValue='1000000'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Amount vector</description>
          </Parameter>
          <Parameter name='CouponRates' libraryType='QuantLib::Rate' exampleValue='0.05'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>coupon fixed rates</description>
          </Parameter>
          <Parameter name='DayCounter' enumeration='QuantLib::DayCounter' exampleValue='Actual/Actual (ISMA)'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>DayCounter used for accrual periods</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlFloatingRateLeg'>
      <libraryFunction>IborLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ScheduleID' libraryClass='Schedule'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Schedule object ID</description>
          </Parameter>
          <Parameter name='PaymentAdj' enumeration='QuantLib::BusinessDayConvention' default='"Following"' exampleValue='Following'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Payment Adjustment: business days convention used for payment dates. Default is Following.</description>
          </Parameter>          
          <Parameter name='Nominal' exampleValue='1000000'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Amount vector</description>
          </Parameter>
          <Parameter name='IborIndex' libraryClass='IborIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>floating IborIndex object ID</description>
          </Parameter>
          <Parameter name='FixingDays' default='QuantLib::Null&lt;QuantLib::Integer&gt;()' exampleValue='2'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>number of business days the fixing precedes the value date. If missing, the IborIndex default is used.</description>
          </Parameter>
          <!--<Parameter name='DayCounter' enumeration='QuantLib::DayCounter' default='QuantLib::DayCounter()'>-->
          <Parameter name='DayCounter' enumeration='QuantLib::DayCounter' exampleValue='Actual/360'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>DayCounter used for accrual periods</description>
            <!--<description>If missing, the IborIndex default is used</description>-->
          </Parameter>
          <Parameter name='Gearings' default='1.0' exampleValue='1'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>the multiplicative coefficients of the floating rate index. Default is 1.0</description>
          </Parameter>
          <Parameter name='Spreads' libraryType='QuantLib::Spread' default='0.0' exampleValue='0.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>floating rate additional spreads</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlCappedFlooredFloatingRateLeg'>
      <libraryFunction>IborLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ScheduleID' libraryClass='Schedule'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Schedule object ID</description>
          </Parameter>
          <Parameter name='PaymentAdj' enumeration='QuantLib::BusinessDayConvention' default='"Following"' exampleValue='"Following"'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Payment Adjustment: business days convention used for payment dates. Default is Following.</description>
          </Parameter>
          <Parameter name='Nominal' exampleValue='1000000'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Amount vector</description>
          </Parameter>
          <Parameter name='IborIndex' libraryClass='IborIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>floating IborIndex object ID</description>
          </Parameter>
          <Parameter name='FixingDays' default='QuantLib::Null&lt;QuantLib::Integer&gt;()' exampleValue='2'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>number of business days the fixing precedes the value date. If missing, the IborIndex default is used.</description>
          </Parameter>
          <!--<Parameter name='DayCounter' enumeration='QuantLib::DayCounter' default='QuantLib::DayCounter()'>-->
          <Parameter name='DayCounter' enumeration='QuantLib::DayCounter' exampleValue='Actual/360'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>DayCounter used for accrual periods</description>
            <!--<description>If missing, the IborIndex default is used</description>-->
          </Parameter>
          <Parameter name='FloorRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()' exampleValue='0.02'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Floor strikes. If missing, no floors are enforced.</description>
          </Parameter>
          <Parameter name='Gearings' default='1.0' exampleValue='1.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>the multiplicative coefficients of the floating rate index. Default is 1.0</description>
          </Parameter>
          <Parameter name='Spreads' libraryType='QuantLib::Spread' default='0.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>floating rate additional spreads</description>
          </Parameter>
          <Parameter name='CapRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()' exampleValue='0.05'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Cap strikes. If missing, no caps are enforced.</description>
          </Parameter>
          <Parameter name='IborCouponPricer' libraryClass='IborCouponPricer'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Ibor coupon pricer object ID</description>
          </Parameter>          
        </Parameters>
      </ParameterList>
    </Constructor>
    
    <Constructor name='qlIborCouponPricer'>
      <libraryFunction>IborCouponPricer</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='Volatility' libToHandle='CapletVolatilityStructure' exampleValue='EURCapletVol'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Caplet Volatility Structure object ID</description>
          </Parameter>
          <Parameter name='IborCouponPricerType' exampleValue='IborByBlack'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Ibor Coupon Pricer Type (e.g IborByBlack, ..)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>   
    
    <Constructor name='qlCmsLeg'>
      <libraryFunction>CmsLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ScheduleID' libraryClass='Schedule'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Schedule object ID</description>
          </Parameter>
          <Parameter name='PaymentAdj' enumeration='QuantLib::BusinessDayConvention' default='"Following"' exampleValue='Following'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Payment Adjustment: business days convention used for payment dates. Default is Following.</description>
          </Parameter>
          <Parameter name='Nominal' exampleValue='1000000'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Amount vector</description>
          </Parameter>
          <Parameter name='SwapIndex' libraryClass='SwapIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>underlying SwapIndex object ID</description>
          </Parameter>
          <Parameter name='FixingDays' default='QuantLib::Null&lt;QuantLib::Integer&gt;()' exampleValue='2'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>number of business days the fixing precedes the value date. If missing, the SwapIndex default is used.</description>
          </Parameter>
          <!-- we might/should use the daycounter of the IborIndex underlying the SwapIndex -->
          <Parameter name='DayCounter' enumeration='QuantLib::DayCounter' exampleValue='Actual/360'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>DayCounter used for accrual periods</description>
          </Parameter>
          <Parameter name='FloorRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Floor strikes. If missing, no floors are enforced.</description>
          </Parameter>
          <Parameter name='Gearings' default='1.0' exampleValue='1.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>the multiplicative coefficients of the floating rate index. Default is 1.0</description>
          </Parameter>
          <Parameter name='Spreads' libraryType='QuantLib::Spread' default='0.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>floating rate additional spreads</description>
          </Parameter>
          <Parameter name='CapRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()' >
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Cap strikes. If missing, no caps are enforced.</description>
          </Parameter>
          <Parameter name='CmsCouponPricer' libraryClass='CmsCouponPricer'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Cms coupon pricer object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlCmsInArrearsLeg'>
      <libraryFunction>CmsInArrearsLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ScheduleID' libraryClass='Schedule'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Schedule object ID</description>
          </Parameter>
          <Parameter name='PaymentAdjustment' enumeration='QuantLib::BusinessDayConvention' default='"Following"'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>business days convention used for payment dates. Default is Following.</description>
          </Parameter>
          <Parameter name='Nominal' exampleValue='1000000'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Amount vector</description>
          </Parameter>
          <Parameter name='SwapIndex' libraryClass='SwapIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>underlying swap index object ID</description>
          </Parameter>
          <Parameter name='FixingDays' default='QuantLib::Null&lt;QuantLib::Integer&gt;()' exampleValue='2'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>number of business days the fixing precedes the value date. If missing, the SwapIndex default is used.</description>
          </Parameter>
          <!-- we might/should use the daycounter of the IborIndex underlying the SwapIndex -->
          <Parameter name='DayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>DayCounter used for accrual periods</description>
          </Parameter>
          <Parameter name='FloorRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Floor strikes. If missing, no floors are enforced.</description>
          </Parameter>
          <Parameter name='Gearings' default='1.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>the multiplicative coefficients of the floating rate index. Default is 1.0</description>
          </Parameter>
          <Parameter name='Spreads' libraryType='QuantLib::Spread' default='0.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>floating rate additional spreads</description>
          </Parameter>
          <Parameter name='CapRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()' >
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Cap strikes. If missing, no caps are enforced.</description>
          </Parameter>
          <Parameter name='CmsCouponPricer' libraryClass='CmsCouponPricer'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Cms coupon pricer object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlCmsZeroLeg'>
      <libraryFunction>CmsZeroLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ScheduleID' libraryClass='Schedule'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Schedule object ID</description>
          </Parameter>
          <Parameter name='PaymentAdjustment' enumeration='QuantLib::BusinessDayConvention' default='"Following"'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>business days convention used for payment dates. Default is Following.</description>
          </Parameter>
          <Parameter name='Nominal' exampleValue='1000000'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Amount vector</description>
          </Parameter>
          <Parameter name='SwapIndex' libraryClass='SwapIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>underlying swap index object ID</description>
          </Parameter>
          <Parameter name='FixingDays' default='QuantLib::Null&lt;QuantLib::Integer&gt;()'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>number of business days the fixing precedes the value date. If missing, the SwapIndex default is used.</description>
          </Parameter>
          <!-- we might/should use the daycounter of the IborIndex underlying the SwapIndex -->
          <Parameter name='DayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>DayCounter used for accrual periods</description>
          </Parameter>
          <Parameter name='FloorRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()' exampleValue='0.00%'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Floor strikes. If missing, no floors are enforced.</description>
          </Parameter>
          <Parameter name='Gearings' default='1.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>the multiplicative coefficients of the floating rate index. Default is 1.0</description>
          </Parameter>
          <Parameter name='Spreads' libraryType='QuantLib::Spread' default='0.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>floating rate additional spreads</description>
          </Parameter>
          <Parameter name='CapRates' libraryType='QuantLib::Rate' default='std::vector&lt;QuantLib::Rate&gt;()' >
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>Cap strikes. If missing, no caps are enforced.</description>
          </Parameter>
          <Parameter name='CmsCouponPricer' libraryClass='CmsCouponPricer'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Cms coupon pricer object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlCmsCouponPricer'>
      <libraryFunction>CmsCouponPricer</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='Volatility' libToHandle='SwaptionVolatilityStructure' exampleValue='EURSwaptionVol'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Swaption Volatility Structure object ID</description>
          </Parameter>
          <Parameter name='CmsCouponPricerType' exampleValue='ConundrumByNumericalIntegration'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>Cms Coupon Pricer Type (e.g ConundrumByBlack, ConundrumByNumericalIntegration, ClassicalAnaliticalFormula)</description>
          </Parameter>
          <Parameter name='ModelOfYieldCurve' enumeration='QuantLib::GFunctionFactory::ModelOfYieldCurve'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>model of the yield curve (e.g Standard, ExactYield, ParallelShifts, NonParallelShifts)</description>
          </Parameter>
          <Parameter name='MeanReversion' libToHandle='Quote'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>mean reversion quote.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlMultiPhaseLeg'>
      <libraryFunction>MultiPhaseLeg</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='legIDs' objectClass='Leg'>
            <type>string</type>
            <tensorRank>vector</tensorRank>
            <description>leg object IDs, one for each phase</description>
          </Parameter>
          <Parameter name='toBeSorted' default='true'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>TRUE if the CashFlows in the merged Leg must be sorted according to date/amount</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

  </Functions>

</Category>
