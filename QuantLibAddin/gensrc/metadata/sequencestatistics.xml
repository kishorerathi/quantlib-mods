<Category name='sequencestatistics'>
  <description>QuantLib statistics analysis of N-dimensional (sequence) data</description>
  <displayName>SequenceStatistics</displayName>
  <xlFunctionWizardCategory>QuantLib - Math</xlFunctionWizardCategory>
  <includes>
    <include>ql/Math/riskstatistics.hpp</include>
    <include>qlo/sequencestatistics.hpp</include>
  </includes>
  <copyright>
    Copyright (C) 2006, 2007 Cristina Duminuco
  </copyright>

  <Functions>

    <!-- SequenceStatistics methods:  1-D inspectors lifted from underlying statistics class -->

    <Member name='qlSequenceStatisticsSamples' libraryClass='SequenceStatistics'>
      <description>Returns the number of samples collected for the given SequenceStatistics object</description>
      <libraryFunction>samples</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsWeightSum' libraryClass='SequenceStatistics'>
      <description>Returns the sum of data weights for the given SequenceStatistics object</description>
      <libraryFunction>weightSum</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <!-- SequenceStatistics methods:  N-D inspectors lifted from underlying statistics class -->

    <Member name='qlSequenceStatisticsMean' libraryClass='SequenceStatistics'>
      <description>Returns the mean for the given SequenceStatistics object</description>
      <libraryFunction>mean</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsVariance' libraryClass='SequenceStatistics'>
      <description>Returns the variance for the given SequenceStatistics object</description>
      <libraryFunction>variance</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsStandardDeviation' libraryClass='SequenceStatistics'>
      <description>Returns the the standard deviation for the given SequenceStatistics object</description>
      <libraryFunction>standardDeviation</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsDownsideVariance' libraryClass='SequenceStatistics'>
      <description>Returns the variance of observations below zero for the given SequenceStatistics object.</description>
      <libraryFunction>downsideVariance</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsDownsideDeviation' libraryClass='SequenceStatistics'>
      <description>Returns the square root of the downside variance for the given SequenceStatistics object.</description>
      <libraryFunction>downsideDeviation</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsSemiVariance' libraryClass='SequenceStatistics'>
      <description>Returns the variance of observations below the mean for the given SequenceStatistics object.</description>
      <libraryFunction>semiVariance</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsSemiDeviation' libraryClass='SequenceStatistics'>
      <description>Returns the square root of the semivariance for the given SequenceStatistics object.</description>
      <libraryFunction>semiDeviation</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsErrorEstimate' libraryClass='SequenceStatistics'>
      <description>Returns the error estimate on the mean value for the given SequenceStatistics object</description>
      <libraryFunction>errorEstimate</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsSkewness' libraryClass='SequenceStatistics'>
      <description>Returns the skewness for the given SequenceStatistics object</description>
      <libraryFunction>skewness</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsKurtosis' libraryClass='SequenceStatistics'>
      <description>Returns the excess kurtosis for the given SequenceStatistics object</description>
      <libraryFunction>kurtosis</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsMin' libraryClass='SequenceStatistics'>
      <description>Returns the minimum sample value for the given SequenceStatistics object</description>
      <libraryFunction>min</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsMax' libraryClass='SequenceStatistics'>
      <description>Returns the maximum sample value for the given SequenceStatistics object</description>
      <libraryFunction>max</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsGaussianPercentile' libraryClass='SequenceStatistics'>
      <description>Returns the x-th percentile for the given SequenceStatistics object.</description>
      <libraryFunction>gaussianPercentile</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='x' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>Must be in the range (0,1]</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsPercentile' libraryClass='SequenceStatistics'>
      <description>Returns the x-th percentile for the given SequenceStatistics object</description>
      <libraryFunction>percentile</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='x' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>Must be in the range (0,1]</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsGaussianPotentialUpside' libraryClass='SequenceStatistics'>
      <description>Returns the reciprocal of VAR at a given percentile for the given SequenceStatistics object.</description>
      <libraryFunction>gaussianPotentialUpside</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the percentile</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsPotentialUpside' libraryClass='SequenceStatistics'>
      <description>Returns the reciprocal of VAR at a given percentile for the given SequenceStatistics object.</description>
      <libraryFunction>potentialUpside</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='centile' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the centile</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsGaussianValueAtRisk' libraryClass='SequenceStatistics'>
      <description>Returns the value-at-risk at a given percentile for the given SequenceStatistics object.</description>
      <libraryFunction>gaussianValueAtRisk</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the percentile</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsValueAtRisk' libraryClass='SequenceStatistics'>
      <description>Returns the value-at-risk at a given percentile for the given SequenceStatistics object.</description>
      <libraryFunction>valueAtRisk</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the percentile</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsRegret' libraryClass='SequenceStatistics'>
      <description>Returns the variance of observations below target for the given SequenceStatistics object.</description>
      <libraryFunction>regret</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the target</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsGaussianShortfall' libraryClass='SequenceStatistics'>
      <description>Returns the probability of missing the given target for the given SequenceStatistics object.</description>
      <libraryFunction>gaussianShortfall</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the target</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsShortfall' libraryClass='SequenceStatistics'>
      <description>Returns the probability of missing the given target for the given SequenceStatistics object.</description>
      <libraryFunction>shortfall</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the target</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsGaussianAverageShortfall' libraryClass='SequenceStatistics'>
      <description>Returns the averaged shortfallness for the given SequenceStatistics object.</description>
      <libraryFunction>gaussianAverageShortfall</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the target</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsAverageShortfall' libraryClass='SequenceStatistics'>
      <description>Returns the averaged shortfallness for the given SequenceStatistics object.</description>
      <libraryFunction>averageShortfall</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='target' exampleValue='0.5'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>the target</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsCovariance' libraryClass='SequenceStatistics'>
      <description>Returns the covariance Matrix for the given SequenceStatistics object</description>
      <libraryFunction>covariance</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Matrix'>
        <type>double</type>
        <tensorRank>matrix</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlSequenceStatisticsCorrelation' libraryClass='SequenceStatistics'>
      <description>Returns the correlation Matrix for the given SequenceStatistics object</description>
      <libraryFunction>correlation</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Matrix'>
        <type>double</type>
        <tensorRank>matrix</tensorRank>
      </ReturnValue>
    </Member>

    <!-- constructor -->

    <Constructor name='qlSequenceStatistics'>
      <description>
        Statistics analysis of N-dimensional (sequence) data.
      </description>
      <libraryFunction>SequenceStatistics</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='dimension' exampleValue='2'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>Statistics dimensionality.</description>
          </Parameter>
          <Parameter name='values' libraryType='QuantLib::Matrix'>
            <!--default='QuantLib::Matrix()'>-->
            <type>double</type>
            <tensorRank>matrix</tensorRank>
            <description>Sampled values. If omitted, an empty statistics is created.</description>
          </Parameter>
          <Parameter name='weights' default='std::vector&lt;QuantLib::Real&gt;()' exampleValue='1.0,1.0'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>If omitted, all sampled values have the same weight.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

  </Functions>
</Category>
