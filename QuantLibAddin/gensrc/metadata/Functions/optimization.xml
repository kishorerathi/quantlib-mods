<Category name='optimization'>
  <description>functions to construct and use Optimization objects</description>
  <displayName>Optimization</displayName>
  <xlFunctionWizardCategory>QuantLib - Math</xlFunctionWizardCategory>
  <includes>
    <include>qlo/optimization.hpp</include>
  </includes>
  <copyright>
    Copyright (C) 2006, 2007 Ferdinando Ametrano
  </copyright>

  <Functions>

    <!-- EndCriteria class and interface -->

    <Procedure name='qlSecondsToString'>
      <description>returns a hh:mm:ss string from the number of seconds provided as input.</description>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='seconds' exampleValue='3661'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>number of seconds</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>string</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Procedure>

    <Member name='qlEndCriteriaMaxIterations' type='QuantLib::EndCriteria'>
      <description>Returns the number of max interation for the given EndCriteria object</description>
      <libraryFunction>maxIterations</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Size</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlEndCriteriaMaxStationaryStateIterations' type='QuantLib::EndCriteria'>
      <description>Returns the number of max interation in a stationary state for the given EndCriteria object</description>
      <libraryFunction>maxStationaryStateIterations</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Size</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlEndCriteriaFunctionEpsilon' type='QuantLib::EndCriteria'>
      <description>Returns the function epsilon for the given EndCriteria object</description>
      <libraryFunction>functionEpsilon</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Real</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlEndCriteriaGradientNormEpsilon' type='QuantLib::EndCriteria'>
      <description>Returns the gradient norm epsilon for the given EndCriteria object</description>
      <libraryFunction>gradientNormEpsilon</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Real</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Constructor name='qlEndCriteria'>
      <libraryFunction>EndCriteria</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='maxIterations' exampleValue='1000'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>max number of iterations.</description>
          </Parameter>
          <Parameter name='maxStationaryStateIterations' exampleValue='100'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>max number of iterations in a stationary state.</description>
          </Parameter>
          <Parameter name='rootEpsilon' exampleValue='1e-8'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>tolerance on the root value.</description>
          </Parameter>
          <Parameter name='functionEpsilon' exampleValue='1e-8'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>tolerance on the function value.</description>
          </Parameter>
          <Parameter name='gradientNormEpsilon' exampleValue='1e-8'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>tolerance on the function gradient norm value.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- OptimizationMethod derived classes' constructors -->

    <Constructor name='qlSimplex'>
      <libraryFunction>Simplex</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name="lambda" exampleValue="0.01">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>lambda (typical scale length of the problem)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlLevenbergMarquardt'>
      <libraryFunction>LevenbergMarquardt</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name="epsfcn" libraryType="QuantLib::Real" default="1.0e-8">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>epsfcn. If omitted, default = 1.0e-8 is used.</description>
          </Parameter>
          <Parameter name="xtol" libraryType="QuantLib::Real" default="1.0e-8">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>xtol. If omitted, default = 1.0e-8 is used.</description>
          </Parameter>
          <Parameter name="gtol" libraryType="QuantLib::Real" default="1.0e-8">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>gtol. If omitted, default = 1.0e-8 is used.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlConjugateGradient'>
      <libraryFunction>ConjugateGradient</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name="lineSearch" default='""'>
            <type>QuantLib::LineSearch</type>
            <tensorRank>scalar</tensorRank>
            <description>LineSearch object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlSteepestDescent'>
      <libraryFunction>SteepestDescent</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name="lineSearch" default='""'>
            <type>QuantLib::LineSearch</type>
            <tensorRank>scalar</tensorRank>
            <description>LineSearch object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- LineSearch derived classes' constructors -->

    <Constructor name='qlArmijoLineSearch'>
      <libraryFunction>ArmijoLineSearch</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name="epsilon" default="1e-8">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>epsilon. If omitted, default = 1e-8 is used.</description>
          </Parameter>
          <Parameter name="alpha" default="0.05">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>alpha. If omitted, default = 0.05 is used.</description>
          </Parameter>
          <Parameter name="beta" default="0.65">
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>beta. If omitted, default = 0.65 is used.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

  </Functions>

</Category>
