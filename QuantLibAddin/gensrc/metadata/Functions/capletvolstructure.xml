<Category name='capletvolstructure'>
  <description>functions to construct and use CapletVolatilityStructure objects</description>
  <displayName>Caplet Volatility Term Structures</displayName>
  <xlFunctionWizardCategory>QuantLib - Financial</xlFunctionWizardCategory>
  <addinIncludes>
    <include>qlo/index.hpp</include>
    <include>qlo/capletvolstructure.hpp</include>
    <include>qlo/quotes.hpp</include>
    <include>ql/termstructures/volatilities/caplet/capletconstantvol.hpp</include>
    <include>ql/termstructures/volatilities/caplet/capstripper.hpp</include>
    <include>qlo/swaptionvolstructure.hpp</include>
  </addinIncludes>
  <serializationIncludes>
    <include>qlo/ValueObjects/vo_capletvolstructure.hpp</include>
    <include>qlo/capletvolstructure.hpp</include>
    <include>qlo/index.hpp</include>
    <include>qlo/quotes.hpp</include>
    <include>ql/termstructures/volatilities/caplet/capletconstantvol.hpp</include>
    <include>ql/termstructures/volatilities/caplet/capstripper.hpp</include>
    <include>qlo/swaptionvolstructure.hpp</include>
  </serializationIncludes>
  <copyright>
    Copyright (C) 2006 Ferdinando Ametrano
  </copyright>
  <Functions>

    <!-- CapletVolatilityStructure interface-->
    <Member name='qlCapletVTSVolatility' type='QuantLib::CapletVolatilityStructure' superType='handleToLib' loopParameter='strike'>
      <description>Returns volatility from the given CapletVolatilityStructure object.</description>
      <libraryFunction>volatility</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='optionDate' exampleValue ='5y'>
            <type>QuantLib::Date</type>
            <tensorRank>scalar</tensorRank>
            <description>caplet/floorlet expiry date</description>
          </Parameter>
          <Parameter name='strike' exampleValue ='0.04' const='False'>
            <type>QuantLib::Rate</type>
            <tensorRank>vector</tensorRank>
            <description>caplet/floorlet strike</description>
          </Parameter>
          <Parameter name='allowExtrapolation' const='False' default='false'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Extrapolation Flag (TRUE allows extrapolation)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Volatility</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSVolatility2' type='QuantLib::CapletVolatilityStructure' superType='handleToLib' loopParameter='strike'>
      <description>Returns volatility from the given CapletVolatilityStructure object.</description>
      <libraryFunction>volatility</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='optionTenor' exampleValue ='5y'>
            <type>QuantLib::Period</type>
            <tensorRank>scalar</tensorRank>
            <description>caplet/floorlet option tenor</description>
          </Parameter>
          <Parameter name='strike' exampleValue ='0.04' const='False'>
            <type>QuantLib::Rate</type>
            <tensorRank>vector</tensorRank>
            <description>caplet/floorlet strike</description>
          </Parameter>
          <Parameter name='allowExtrapolation' const='False' default='false'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Extrapolation Flag (TRUE allows extrapolation)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Volatility</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>
    
    <Member name='qlCapletVTSBlackVariance' type='QuantLib::CapletVolatilityStructure' superType='handleToLib' loopParameter='optionDate'>
      <description>Returns a vector of black volatilities corresponding to a vector of strikes for a given exercise date.</description>
      <libraryFunction>blackVariance</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='optionDate' exampleValue ='5y'>
            <type>QuantLib::Date</type>
            <tensorRank>vector</tensorRank>
            <description>cap/floor expiry date</description>
          </Parameter>
          <Parameter name='strike' exampleValue ='0.04' const='False'>
            <type>QuantLib::Rate</type>
            <tensorRank>scalar</tensorRank>
            <description>cap/floor strike vector</description>
          </Parameter>
          <Parameter name='allowExtrapolation' const='False'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Extrapolation Flag (TRUE allows extrapolation)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSBlackVariance2' type='QuantLib::CapletVolatilityStructure' superType='handleToLib' loopParameter='optionTenor'>
      <description>Returns a vector of black volatilities corresponding to a vector of strikes for a given exercise date.</description>
      <libraryFunction>blackVariance</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='optionTenor' exampleValue ='5y'>
            <type>QuantLib::Period</type>
            <tensorRank>vector</tensorRank>
            <description>cap/floor expiry date</description>
          </Parameter>
          <Parameter name='strike' exampleValue ='0.04' const='False'>
            <type>QuantLib::Rate</type>
            <tensorRank>scalar</tensorRank>
            <description>cap/floor strike vector</description>
          </Parameter>
          <Parameter name='allowExtrapolation' const='False'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Extrapolation Flag (TRUE allows extrapolation)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSMinStrike' type='QuantLib::CapletVolatilityStructure' superType='handleToLib'>
      <description>Returns the minimum strike for which the given CapletVolatilityStructure can return vols.</description>
      <libraryFunction>minStrike</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Rate</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSMaxStrike' type='QuantLib::CapletVolatilityStructure' superType='libraryClass'>
      <description>Returns the maximum strike for which the given CapletVolatilityStructure can return vols.</description>
      <libraryFunction>maxStrike</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Rate</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <!-- RelinkableHandle<CapletVolatilityStructure> -->
    <Constructor name='qlRelinkableHandleCapletVolatilityStructure'>
      <libraryFunction>RelinkableHandle&lt;QuantLib::CapletVolatilityStructure&gt;</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='currentLink' default='""'>
            <type>QuantLib::CapletVolatilityStructure</type>
            <superType>libraryClass</superType>
            <tensorRank>scalar</tensorRank>
            <description>CapletVolatilityStructure object ID. If omitted, nothing is linked by the RelinkableHandle.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Member name='qlRelinkableHandleCapletVolatilityStructureLinkTo' type='QuantLib::CapletVolatilityStructure' superType='objectHandle'>
      <libraryFunction>linkTo</libraryFunction>
      <description>relink handle</description>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='currentLink' >
            <type>QuantLib::CapletVolatilityStructure</type>
            <superType>libraryClass</superType>
            <tensorRank>scalar</tensorRank>
            <description>CapletVolatilityStructure object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>void</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>
    
    <!-- CapletVolatilityStructure constructors -->
    <Constructor name='qlCapletVTSConstant'>
      <libraryFunction>CapletConstantVolatility</libraryFunction>
      <functionCategory>QuantLib</functionCategory>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='volatility' >
            <type>QuantLib::Quote</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>cap/floor constant volatility Quote</description>
          </Parameter>
          <Parameter name='dayCounter'>
            <type>QuantLib::DayCounter</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- CapsStripper interface-->
    <Member name='qlCapsStripperStrikes' type='QuantLib::CapsStripper'>
      <description>Returns the vector of cap strikes underlying the given ObjectID.</description>
      <libraryFunction>strikes</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Rate</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapsStripperTenors' type='QuantLib::CapsStripper'>
      <description>Returns the vector of cap tenors underlying the given ObjectID.</description>
      <libraryFunction>tenors</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='true' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Period</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Constructor name='qlCapsStripper'>
      <libraryFunction>CapsStripper</libraryFunction>
      <functionCategory>QuantLib</functionCategory>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='capTenors'>
            <type>QuantLib::Period</type>
            <tensorRank>vector</tensorRank>
            <description>cap lengths.</description>
          </Parameter>
          <Parameter name='capStrikes'>
            <type>QuantLib::Rate</type>
            <tensorRank>vector</tensorRank>
            <description>cap strikes.</description>
          </Parameter>
          <Parameter name='volatilities' >
            <type>QuantLib::Quote</type>
            <superType>libToHandle</superType>
            <tensorRank>matrix</tensorRank>
            <description>cap volatilities.</description>
          </Parameter>
          <Parameter name="index">
            <type>QuantLib::IborIndex</type>
            <tensorRank>scalar</tensorRank>
            <description>cap index object ID</description>
          </Parameter>
          <Parameter name='YieldCurve' >
            <type>QuantLib::YieldTermStructure</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
          <Parameter name='dayCounter'>
            <type>QuantLib::DayCounter</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
          <Parameter name='impliedVolatilityAccuracy'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility Accuracy.</description>
          </Parameter>
          <Parameter name='maxEvaluations'>
            <type>QuantLib::Size</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility max Evaluations.</description>
          </Parameter>
          <Parameter name='decoupledInterpolation' const='false'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Used decoupled interpolations</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlCapsStripper2'>
      <libraryFunction>CapsStripper</libraryFunction>
      <functionCategory>QuantLib</functionCategory>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='capTenors'>
            <type>QuantLib::Period</type>
            <tensorRank>vector</tensorRank>
            <description>cap lengths.</description>
          </Parameter>
          <Parameter name='capStrikes'>
            <type>QuantLib::Rate</type>
            <tensorRank>vector</tensorRank>
            <description>cap strikes.</description>
          </Parameter>
          <Parameter name='volatilities' >
            <type>QuantLib::Quote</type>
            <superType>libToHandle</superType>
            <tensorRank>matrix</tensorRank>
            <description>cap volatilities.</description>
          </Parameter>
          <Parameter name="index">
            <type>QuantLib::IborIndex</type>
            <tensorRank>scalar</tensorRank>
            <description>cap index object ID</description>
          </Parameter>
          <Parameter name='YieldCurve' >
            <type>QuantLib::YieldTermStructure</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
          <Parameter name='dayCounter'>
            <type>QuantLib::DayCounter</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
          <Parameter name='impliedVolatilityAccuracy'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility Accuracy.</description>
          </Parameter>
          <Parameter name='maxEvaluations'>
            <type>QuantLib::Size</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility max Evaluations.</description>
          </Parameter>
          <Parameter name='smileSections'>
            <type>QuantLib::SmileSection</type>
            <tensorRank>vector</tensorRank>
            <description>smile sections object IDs</description>
          </Parameter>
          <Parameter name='decoupledInterpolation' const='false'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Used decoupled interpolations</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlSmileSectionsVolStructure'>
      <libraryFunction>SmileSectionsVolStructure</libraryFunction>
      <functionCategory>QuantLib</functionCategory>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='referenceDate'>
            <type>QuantLib::Date</type>
            <tensorRank>scalar</tensorRank>
            <description>reference date</description>
          </Parameter>
          <Parameter name='dayCounter'>
            <type>QuantLib::DayCounter</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
          <Parameter name='smileSections'>
            <type>QuantLib::SmileSection</type>
            <tensorRank>vector</tensorRank>
            <description>smile sections object IDs</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlSpreadedCapletVolatilityStructure'>
      <libraryFunction>SpreadedCapletVolatilityStructure</libraryFunction>
      <functionCategory>QuantLib</functionCategory>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel' calcInWizard='false' />
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='CapletVolatilityStructure' >
            <type>QuantLib::CapletVolatilityStructure</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>Caplet volatility structure object ID</description>
          </Parameter>
          <Parameter name='spread'>
            <type>QuantLib::Quote</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>spread</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>
    
  </Functions>
</Category>
