<Category name='volatilities'>
  <description>functions to construct and use volatility objects</description>
  <displayName>Volatilities</displayName>
  <xlFunctionWizardCategory>QuantLib - Financial</xlFunctionWizardCategory>
  <includes>
    <include>qlo/volatilities.hpp</include>
    <include>ql/Math/sabrinterpolation.hpp</include>
  </includes>
  <copyright>
    Copyright (C) 2005, 2006 Eric Ehlers
  </copyright>
  <Functions>

    <Procedure name='qlSabrVolatility'>
      <description>Sabr formula for smile volatility</description>
      <alias>QuantLib::sabrVolatility</alias>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='strike' exampleValue ='0.06'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>option strike</description>
          </Parameter>
          <Parameter name='forward' exampleValue ='0.04'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>underlying forward value</description>
          </Parameter>
          <Parameter name='expTime' exampleValue ='1.0'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>expiry time (in years)</description>
          </Parameter>
          <Parameter name='alpha' exampleValue ='0.02'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>alpha</description>
          </Parameter>
          <Parameter name='beta' exampleValue ='0.6'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>beta</description>
          </Parameter>
          <Parameter name='nu' exampleValue ='.02'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>nu</description>
          </Parameter>
          <Parameter name='rho' exampleValue ='0.03'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>rho</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Procedure>

    <Constructor name='qlBlackConstantVol'>
      <libraryFunction>BlackConstantVol</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
        <C/>
        <Calc/>
        <Guile/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='settlementDate' libraryType='QuantLib::Date' exampleValue ='0D'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>settlement date</description>
          </Parameter>
          <Parameter name='volatility' exampleValue ='0.2'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>volatility</description>
          </Parameter>
          <Parameter name='dayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlBlackVarianceSurface'>
      <libraryFunction>BlackVarianceSurface</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='settlementDate' libraryType='QuantLib::Date' exampleValue ='0D'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>settlement date</description>
          </Parameter>
          <Parameter name='dates' libraryType='QuantLib::Date' exampleValue ='3m, 1y, 5y'>
            <type>long</type>
            <tensorRank>vector</tensorRank>
            <description>dates</description>
          </Parameter>
          <Parameter name='strikes' exampleValue ='0.03, 0.05, 0.10'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>strikes</description>
          </Parameter>
          <Parameter name='volatilities' libraryType='QuantLib::Matrix'>
            <type>double</type>
            <tensorRank>matrix</tensorRank>
            <description>volatilities</description>
          </Parameter>
          <Parameter name='dayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

  </Functions>
</Category>
