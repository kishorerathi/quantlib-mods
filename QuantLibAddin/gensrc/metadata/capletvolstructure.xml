<Category name='capletvolstructure'>
  <description>functions to construct and use CapletVolatilityStructure objects</description>
  <displayName>Caplet Volatility Term Structures</displayName>
  <xlFunctionWizardCategory>QuantLib - Financial</xlFunctionWizardCategory>
  <includes>
    <include>qlo/index.hpp</include>
    <include>qlo/capletvolstructure.hpp</include>
    <include>qlo/quotes.hpp</include>
    <include>ql/Volatilities/capletconstantvol.hpp</include>
    <include>ql/Volatilities/capstripper.hpp</include>
    <include>qlo/swaptionvolstructure.hpp</include>
  </includes>
  <copyright>
    Copyright (C) 2006 Ferdinando Ametrano
  </copyright>
  <Functions>

    <!-- CapletVolatilityStructure interface-->
    <Member name='qlCapletVTSVolatility' libraryClass='CapletVolatilityStructure' loopParameter='strikes'>
      <description>Returns a vector of volatilities corresponding to a vector of strikes for a given exercise date.</description>
      <libraryFunction>volatility</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='expiry' libraryType='QuantLib::Date'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>cap/floor expiry date</description>
          </Parameter>
          <Parameter name='strikes' libraryType='QuantLib::Rate' const='False'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>cap/floor strike vector</description>
          </Parameter>
          <Parameter name='allowExtrapolation' const='False'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Extrapolation Flag (TRUE allows extrapolation)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Volatility</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSBlackVariance' libraryClass='CapletVolatilityStructure' loopParameter='strikes'>
      <description>Returns a vector of black volatilities corresponding to a vector of strikes for a given exercise date.</description>
      <libraryFunction>blackVariance</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='expiry' libraryType='QuantLib::Date'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>cap/floor expiry date</description>
          </Parameter>
          <Parameter name='strikes' libraryType='QuantLib::Rate' const='False'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>cap/floor strike vector</description>
          </Parameter>
          <Parameter name='allowExtrapolation' const='False'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Extrapolation Flag (TRUE allows extrapolation)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSMinStrike' libraryClass='CapletVolatilityStructure'>
      <description>Returns the minimum strike for which the term structure can return vols.</description>
      <libraryFunction>minStrike</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Rate'>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapletVTSMaxStrike' libraryClass='CapletVolatilityStructure'>
      <description>Returns the maximum strike for which the term structure can return vols.</description>
      <libraryFunction>maxStrike</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Rate'>
        <type>double</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <!-- CapletVolatilityStructure constructors -->
    <Constructor name='qlCapletVTSConstant'>
      <libraryFunction>CapletConstantVolatility</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='volatility' libToHandle='Quote'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>cap/floor constant volatility Quote</description>
          </Parameter>
          <Parameter name='dayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- CapsStripper interface-->
    <Member name='qlCapsStripperStrikes' libraryClass='CapsStripper'>
      <description>Returns the vector of cap strikes underlying the given ObjectID.</description>
      <libraryFunction>strikes</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Rate'>
        <type>double</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Member name='qlCapsStripperTenors' libraryClass='CapsStripper'>
      <description>Returns the vector of cap tenors underlying the given ObjectID.</description>
      <libraryFunction>tenors</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='true' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters/>
      </ParameterList>
      <ReturnValue libraryType='QuantLib::Period'>
        <type>string</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>

    <Constructor name='qlCapsStripper'>
      <libraryFunction>CapsStripper</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='capTenors' libraryType='QuantLib::Period'>
            <type>string</type>
            <tensorRank>vector</tensorRank>
            <description>cap lengths.</description>
          </Parameter>
          <Parameter name='capStrikes' libraryType='QuantLib::Rate'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>cap strikes.</description>
          </Parameter>
          <Parameter name='volatilities' libToHandle='Quote'>
            <type>string</type>
            <tensorRank>matrix</tensorRank>
            <description>cap volatilities.</description>
          </Parameter>
          <Parameter name="index" libraryClass='IborIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>cap index object ID</description>
          </Parameter>
          <Parameter name='YieldCurve' libToHandle='YieldTermStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
          <Parameter name='dayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
          <Parameter name='impliedVolatilityAccuracy' libraryType='QuantLib::Real'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility Accuracy.</description>
          </Parameter>
          <Parameter name='maxEvaluations' libraryType='QuantLib::Size'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility max Evaluations.</description>
          </Parameter>
         <Parameter name='decoupledInterpolation' const='false'>
             <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Used decoupled interpolations</description>
         </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlCapsStripper2'>
      <libraryFunction>CapsStripper</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='capTenors' libraryType='QuantLib::Period'>
            <type>string</type>
            <tensorRank>vector</tensorRank>
            <description>cap lengths.</description>
          </Parameter>
          <Parameter name='capStrikes' libraryType='QuantLib::Rate'>
            <type>double</type>
            <tensorRank>vector</tensorRank>
            <description>cap strikes.</description>
          </Parameter>
          <Parameter name='volatilities' libToHandle='Quote'>
            <type>string</type>
            <tensorRank>matrix</tensorRank>
            <description>cap volatilities.</description>
          </Parameter>
          <Parameter name="index" libraryClass='IborIndex'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>cap index object ID</description>
          </Parameter>
          <Parameter name='YieldCurve' libToHandle='YieldTermStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>discounting yield term structure object ID</description>
          </Parameter>
          <Parameter name='dayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
          <Parameter name='impliedVolatilityAccuracy' libraryType='QuantLib::Real'>
            <type>double</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility Accuracy.</description>
          </Parameter>
          <Parameter name='maxEvaluations' libraryType='QuantLib::Size'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>implied Volatility max Evaluations.</description>
          </Parameter>
          <Parameter name='smileSections' libraryClass='SmileSection'>
            <type>string</type>
            <tensorRank>vector</tensorRank>
            <description>smile sections object IDs</description>
          </Parameter>
          <Parameter name='decoupledInterpolation' const='false'>
            <type>bool</type>
            <tensorRank>scalar</tensorRank>
            <description>Used decoupled interpolations</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlSmileSectionsVolStructure'>
      <libraryFunction>SmileSectionsVolStructure</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='referenceDate' libraryType='QuantLib::Date'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>reference date</description>
          </Parameter>
          <Parameter name='dayCounter' enumeration='QuantLib::DayCounter'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>day counter (e.g. Actual/360)</description>
          </Parameter>
          <Parameter name='smileSections' libraryClass='SmileSection'>
            <type>string</type>
            <tensorRank>vector</tensorRank>
            <description>smile sections object IDs</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- Handle<CapletVolatilityStructure> -->
    <Constructor name='qlHandleCapletVolatilityStructuree'>
      <libraryFunction>Handle&lt;QuantLib::CapletVolatilityStructure&gt;</libraryFunction>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='capletVol' libraryClass='CapletVolatilityStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>CapletVolatilityStructure object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Member name='qlHandleCapletVolatilityStructureLinkTo' objectClass='Handle&lt;QuantLib::CapletVolatilityStructure&gt;'>
      <libraryFunction>linkTo</libraryFunction>
      <description>relink handle</description>
      <SupportedPlatforms>
        <Excel calcInWizard='false' />
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='capletVol' libraryClass='CapletVolatilityStructure'>
            <type>string</type>
            <tensorRank>scalar</tensorRank>
            <description>CapletVolatilityStructure object ID</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>void</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

  </Functions>
</Category>
