<Category name='calendar'>
  <description>Calendar related QuantLib functions</description>
  <displayName>Calendar</displayName>
  <includes>
    <include>ql/Functions/calendars.hpp</include>
    <include>qla/calendar.hpp</include>
    <include>qla/vo_calendar.hpp</include>
  </includes>
  <Functions>

    <Procedure name='qlIsHoliday' >
      <description>returns TRUE if the date is a holiday for the given calendar</description>
      <functionCategory>QuantLib</functionCategory>
      <alias>QuantLib::isHoliday</alias>
      <Parameters>
        <Parameter name='calendar' ql_type='QuantLib::Calendar'>
          <type>string</type>
          <tensorRank>scalar</tensorRank>
          <description>Calendar to use for holiday determination</description>
        </Parameter>
        <Parameter name='date' ql_type='QuantLib::Date'>
          <type>long</type>
          <tensorRank>scalar</tensorRank>
          <description>date</description>
        </Parameter>
      </Parameters>
      <ReturnValue>
        <type>bool</type>
        <tensorRank>scalar</tensorRank>
        <description>TRUE if the date is a holiday for the given calendar</description>
      </ReturnValue>
    </Procedure>

    <Procedure name='qlIsEndOfMonth' >
      <description>returns TRUE if the date is last business day for the month in the given calendar</description>
      <functionCategory>QuantLib</functionCategory>
      <alias>QuantLib::isEndOfMonth</alias>
      <Parameters>
        <Parameter name='calendar' ql_type='QuantLib::Calendar'>
          <type>string</type>
          <tensorRank>scalar</tensorRank>
          <description>Calendar to use for holiday determination</description>
        </Parameter>
        <Parameter name='date' ql_type='QuantLib::Date'>
          <type>long</type>
          <tensorRank>scalar</tensorRank>
          <description>date</description>
        </Parameter>
      </Parameters>
      <ReturnValue>
        <type>bool</type>
        <tensorRank>scalar</tensorRank>
        <description>TRUE if the date is last business day for the month in the given calendar</description>
      </ReturnValue>
    </Procedure>

    <Procedure name='qlHolidayList' >
      <description>returns the holidays in a period between two dates according to a given holiday calendar</description>
      <functionCategory>QuantLib</functionCategory>
      <alias>QuantLib::holidayList</alias>
      <Parameters>
        <Parameter name='calendar' ql_type='QuantLib::Calendar'>
          <type>string</type>
          <tensorRank>scalar</tensorRank>
          <description>Calendar to use for holiday determination</description>
        </Parameter>
        <Parameter name='fromDate' ql_type='QuantLib::Date'>
          <type>long</type>
          <tensorRank>scalar</tensorRank>
          <description>first date of the period</description>
        </Parameter>
        <Parameter name='toDate' ql_type='QuantLib::Date'>
          <type>long</type>
          <tensorRank>scalar</tensorRank>
          <description>last date of the period</description>
        </Parameter>
        <Parameter name='includeWeekEnds' default='false'>
          <type>bool</type>
          <tensorRank>scalar</tensorRank>
          <description>include week-end as holidays</description>
        </Parameter>
      </Parameters>
      <ReturnValue conversionString='QuantLibAddin::dateToLongVec( %s )'>
        <type>QuantLib::Date</type>
        <tensorRank>vector</tensorRank>
        <description>holidays</description>
      </ReturnValue>
    </Procedure>

    <Procedure name='qlAdvanceCalendar' >
      <description>advances a date according to a given calendar</description>
      <functionCategory>QuantLib</functionCategory>
      <alias>QuantLib::advanceCalendar</alias>
      <Parameters>
        <Parameter name='startDate' ql_type='QuantLib::Date'>
          <type>long</type>
          <tensorRank>scalar</tensorRank>
          <description>start date to be advanced</description>
        </Parameter>
        <Parameter name='n'>
          <type>long</type>
          <tensorRank>scalar</tensorRank>
          <description>number of units to advance</description>
        </Parameter>
        <Parameter name='timeUnits' ql_type='QuantLib::TimeUnit'>
          <type>string</type>
          <tensorRank>scalar</tensorRank>
          <description>units to advance</description>
        </Parameter>
        <Parameter name='calendar' ql_type='QuantLib::Calendar'>
          <type>string</type>
          <tensorRank>scalar</tensorRank>
          <description>Calendar to be used for advancing the date</description>
        </Parameter>
        <Parameter name='BusinessDayConvention' ql_type='QuantLib::BusinessDayConvention'>
          <type>string</type>
          <tensorRank>scalar</tensorRank>
          <description>Business Day Convention (e.g. ModifiedFollowing)</description>
        </Parameter>
      </Parameters>
      <ReturnValue return_func='serialNumber'>
        <type>long</type>
        <tensorRank>scalar</tensorRank>
        <description>advanced date</description>
      </ReturnValue>
    </Procedure>

    <Constructor name='qlJointCalendar'>
      <libraryFunction>JointCalendar</libraryFunction>
      <functionCategory>QuantLib</functionCategory>
      <Parameters>
          <Parameter name='jointCalendarRule' ql_type='QuantLib::JointCalendarRule' default='"JoinHolidays"'>
              <type>string</type>
              <tensorRank>scalar</tensorRank>
              <description>JoinHolidays/JoinBusinessDays</description>
          </Parameter>
          <Parameter name='calendars'><!--ql_type='QuantLib::Calendar'-->
              <type>string</type>
              <tensorRank>vector</tensorRank>
              <description>list of two, three or four calendars to join</description>
          </Parameter>
      </Parameters>
    </Constructor>

  </Functions>
</Category>

