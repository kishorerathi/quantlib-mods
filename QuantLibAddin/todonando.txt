
class Fixing : public Event {
  private:
    boost::shared_ptr<FloatingRateCoupon> coupon_;
  public:
    ... // constructor
    Date date() const { return coupon_->fixingDate(); }
    boost::shared_ptr<FloatingRateCoupon> coupon() const;
};


class Instrument {
  public:
    ...
    std::list<boost::shared_ptr<Event> > events(const Date&) const;
};



======= TODO ===============

---
GENERAL
- everybody please:
  note handles behaviour
  switch to dynamic xll
  remove useless env variables (all but QUANTLIBXL_CONFIG_PATH which should
    point at C:\Projects\QuantLibSVN\trunk\Launcher)
  be ready to debug DevCycle revisions
  switch to boost 1.34 (bjam --toolset=msvc-8.0 install)
  clean up qlo\xxx.hpp files from ql inclusions
  avoid (implicitly) using ActiveWorkbook and ActiveWorksheet in VBA code
  remove trigger ohretrieveError() calls
  familiarize with ohObjectSave() ohObjectLoad()
  familiarize with ohPropertyNames and ohPropertyValue()
  VBA option explicit

- rename onForwardCmsPrice
- remove qlo/simplecashflow.hpp
- review with Eric BlackCalculator/BlackScholesCalculator (and remove default constructor)
- review with Eric PricingEngine (and remove default constructor)
- add ohxlversion
- rename QuantLibXLDynamic to QuantLibXL: use only -s to discriminate?
- review QL::RelinkableHandle usage in QLO
- apply Luigi's clean up to QLO, etc code
- remove ql/handle.hpp dependency
- review qlo/handle.hpp
- review qlo/process.hpp
- review qlo/quote.hpp (remove ql dependency)
- can we remove quantlibaddin.cpp ??
- use ValueObject for x,y interpolation persistance?
- fix bug XS0093295953 PropertyValue("Coupons")
- close all must stop refresh and should not activate
- swaption smile vega (risultati con De Nuccio)
- perche' SABR interpolation ha un data member forward_
- export FRARateHelper and BondRateHelper
- automatic cast from IMM code to date and get FuturesRateHelper in line
  bertween QL and QLA
- change QLA::DepositRateHelper as in QL::DepositRateHelper
- add docs-project to sln
- remove bat from testsuite/bin
- avoid ignoring class of files, as in *.suo
- what is included in serialization files
- subscribe to SA mailing list
- where is qlcalendar advance in the wizard
- why cell menu "format as" doesn't work on multiple selection?
- wbk open must reopen in the last folder
- RateHelpers refactoring (using indexes)
- cubic parameters as input to PiecewiseYieldCurve
- caplet/swaption calibration
* just one test with multiple unit-test
* check new cotsmm corr and old one
* use more realistic corr structure in test suite
  verify yc bootstrapping
  check corr times includes all rate times but the last
  check original calib result before deleting it
  object wizard does not paste InterpolationTraits
  1D as default value instead of exampleValue in hist corr
  check displacements
* market model creation from calibrator
  check if homo = false still crashes
  first rate issue (i.e. when a solution does not exist)
  duplicate pseudorootfacade checks in the new constructor
  multiple displacements for swap indexes
  check if iterative approach make it worse when there is a failure
  check/enforce alpha_i > 1/t_i
* conditional formatting on calibration errors in 1Y wbk
- adapter from LMM to CMSMM
- every factor in MM might have its own vol model
- profiling MM
- USD yield curve and swaption vols
- QuantLib.xla: remove all ActiveWorkbook usage
- cap pricing quality
- restore floating exception in test-suite
- introduce type QuantLib::Money
- wiki documentation
- automated build system
- adopt boost::date
- use boost property map in OH
- have VBA code in text files

---
NANDO
- test ForwardPeriodAdapter
- wbk_close: if read-only do not ask for saving
- use class QuantLib::PiecewiseYieldCurve (Traits, Interpolation)
  for HistoricalForwardRatesAnalysis
- per Luigi: floating point exception + pricing engines observers dei market
  data
- all wbks must use qlxlVersion(true, Trigger)
- check testsuite error when QL_INDEXED_COUPON is used
- production: writing privileges (xla and the rest)
- debug hook at xll loading (for debugging start-up actions)
- VS Express
- check Index used in Mx bootstrapping
- leggere CDS docs
- ref market data set for test suite
- evaluation date observers
- handle incomplete Reuters menu
- handle already loaded addin
- special handling of reuters/bloomberg addins
- manage auto-open macro problem -> propose:
  Application.EnableEvents=True in qlxl.xla/ThisWorkbook
- TermStructure time interface
- recreating object quotes...
- Higham covariance bug + review rank reduction
- create relinkableHandle, then in ControlPanel only use linkTo
- Instruments subfolder
- vol term structure refactoring
- joint calendar
- mkt convention struct
- YCDemo crash
- make BlackCalculator observer/observable, make it lazy
- Risk, Wilmott papers (REMIND: VERIFICARE COPIE DISPERSE)
- review dei seguenti workbooks: YC_SwapDemo.xls, IndexMethodsEnumOrObj.xls
- refactor abcd vol file, adding more unary_functions for blackVol and
  covariance
- implement abcdinterpolation

---
K
SA	49%
bug fix	20%
test	14%
CW	18%


- TRIMESTRALE
- action for setEvaluationDate
- evitare di dover chiudere dopo il refresh snapshot prima delle calibrazioni
  (K & Cri)
- TimeSeries serialization
- all handle used in main checks should be created in handles.xls
- Design e gestione della USD currency per contribuzione swaption vols
DONE add sa.xll to testing environment
DONE Run Main Checks -> Open Main Checks
- time series
    *DONE Refresh snapshot vba: estendere alle ts se open & editable
    *DONE Switch Data vba: verificare se estendere alle ts
    *DONE Verifica che macro che chiude le ts salva i fogli a False -> no è gestito in apertura
    *DONE Close Live Feed vba: deve chiudere anche le ts se open
    *DONE re-organize Quote/TimeSeries menus
    *DONE qlxlversion and trigger formatting in time series
    *Gestione smart per poter estendere le ts dinamicamente
- Workbook_BeforeClose to remove triggers (verifica su pc diversi)
  su foglio ManualCapFeed
- Rt Update
  -> no evidence of stopping problems on our pcs
  -> prepared wkb to test on traders' pc (next week)
- coveredWarrants.xls
    *DONE check delta price in terms of vega with flat vol 		(1d/2d)
- Sensitivity Analysis (K&Cristina):  				(7.5d/5w)
  - General
    run sa on rates, atm vols and vol spreads
    save daily results to check replication
    Eric: flag on deal, tick value, error msg (by eow)
    Eric: upgrade user interface (by end of next week)
    parallel shift added by default
    centered differences, then gamma
    theta SA
    xml output
    sensitivity to index fixings
    list all quotes that we could analize
    discriminate between invalid quote -> #NA()
       and error obtained after having tweaked a quote -> #NUM
  - Irs
      *create book (test_fe_2) of irs seasoned deals in Mx	(done)
      *check null vega of swap ptf (ATM+smile)			(done)
      *test delta on irs spot single deals = Mx 			(done)
      *test delta on irs seasoned book = Mx         		(done)
      *test delta on irs manual = sa code 			(done)
      *generated .xls report 					(done)
      *test fixing effect on pricing				(done)
        a.present on spot starting irs
        b.present on seasoned irs (via swap rate helpers)
      *test fixing effect on sa					()
        a.spot starting irs
        b.seasoned irs 						()
      *test setting Extrapolation = False in Yield Curve bootstrapping.xls
        a.effect on pricing
        b.effect on sa
  - Swaption
    - create book (test_fe_1) of swaptions in Mx & QLXL		(done)
    - create book of not ATM (seasoned) swaption, X=3.5%	(done)
    - test on swaptions book (atm+smile)
  - Cms
    - test on cms books
- foglio di Clerici per contribuire le cap forw/forw vol su Mx 		(1.5d/5d)
	confronto forw/forw vols foglio clerici vs nostro cap stripper 	(0.5d/1.5d)
	sostituzione di tutte le funzioni vba con ql()
	scarico del campo hist_close da Reuters -> usato solo per
	                                           controllo/supporto
	opzione uso AllQuotes vs OTM Only
	parallel shift from straddle prices +
	linear interp sulle expiry times calcolate sull'eval date
		-> aggiustamento dei param di calibr
	opzione per interp vol vs interp params
	pricing degli straddle su futures options
	modello di correlazione per costruire le 6m vol dalle 3m vol
	cubic spline interp per ogni strike sulla matrice estesa delle 6M
	abcd adjustment della matrice delle forw/forw vol
	contribuzione su Mx delle 1m, 3m, 6m, 1y
- 3M cap stripper: 	(0/3w)
	overview: focus on smile sections
	sensitivity to market data
	gestione manuale ordinaria (con Clerici)
	prendere possesso foglio Clerici
	reintroduzione in 6M cap stripper
	test wbk: abcd fit
  	atm backbone: CapStripper3MTestSmoothness.xls
- 6M cap stripper: (1.5D/1w)
	decidere se usare le interpolated vols da usare nel cap stripper
- bug in function SetRealTime() -> Rt seems not to switch settings
- migliora la macro "Copy Values" in SingleMeanReversion.xls
- rimuovere Singleton and set YTS to Euribor
- manual feeds: CalibrationParametersFeed partially updated to live/overwrite
  logic
** Calibrations: UpperBoundary calculation -> root not bracketed


---
CRISTINA
- chiusure DRM 29/6 e creazione ambiente dedicato
- create greeks workbook
- swaptionvolcube test with floating date  (2D/2D - DONE)
- test that the manual procedure to set back/forward the evaluation
  date returns the same results of the automatic procedure  (1D/1D - DONE)
- test for relinkability (CMS npv + greeks)           (DONE for NPV)
- test valid object creation with ALL quotes not initialized
  verify smile sections (no unknown ID error message) (1D - DONE)
- use OTM options instead of ITM options in all abcd wbks
- evitare di dover chiudere dopo il refresh snapshot prima delle calibrazioni
  (K & Cri)
- deals serialization
- cap/floor flow analysis
- digital coupon pricing with analytic formula
- arrange session on digitals
- IFR fixings, check deals
- verify excessive number of input parameter in DigitalLeg
- verify Murex daycount definition
- fix number of relevant digits in all (forecasted) index fixings
- sensitivity analysis (6D/1M)
- daily trunk check and CMS calibration
- testsuite: check volatility when shifting evaluation date (1D/3D)
- change class CappedFlooredIborCoupon in order to add the
  possibility of adding/subracting call and put   (1D/2D)
- Cap Cms Book:
  - pricing of Cms Cap without decomposition in Excel (To be discussed)
  - new management of additional cashflows in Cap Cms book (0D/1D - STAND-BY)
- install VS in new pc (0D/1D)
- market models: abcd for displaced vols (Chiara, Cristina, K)

---
CHIARA
- mimic Grisafi session avery day all day long on IngFin workstation (Done see results in: X:\Offices\Financial Engineering\Derivatives Modelling\Projects\QuantLib\StructuredBonds)
- Digital Bond contructor (5.0d|10dd|Wip)
  - decompose each deal in different legs: one wbk per deal (Done)
  - digitalcmsratebond constructor + digitalfloatingratebond constructor
    without cap and floor
- debug cmsratebond constructor for cms bond paying once in arrears (e.g.
  IT0003650998.pdf) (0d|1d)
  -prospectus added in Drafts
- cds options (with Giorgio) (1.5d-30dd|WIP)
  - analysis of the trader's workbook
  - verified correct installation of Launcher, access given to the trader to
    the 3 different environments on the network
  - sent request to desktop service so to add the user to CABOTOXL
  - arrange session with nando
- markedata\BloombergFeed (Maurizio Pietrini)
  - 7/6 clarified once again mkt data feed for interestratequotesfeed.xls
  - 7/9 received first workbook interestratequotesfedd.xls incompleted from Maurizio
  - 7/10 replied with feedback on the first workbook
- zspread/yield inversion (lehman's paper values can optionally be reproduces
  in the testsuite)
- zerospreadedtermstructure: daycounter bug
- bonds' workbooks integration with K+/Gatemate
- Multicallable bond constructor
- review bond equivalent fo Reverse FRN
- implement alternative version of bond instrument which should accept a leg
  object
- fare tutti i metodi dei bond restituiscano un InterestRate
- i ThMethod perche' non accettano anche loro una Date settlementDate = Date()?

---
FRANCOIS
- allow the user to choose traits and interpolator in the
  HistoricalForwardRatesAnalysis class (and expose it to
  Excel as traits aware)
- removing any trigger in the ohretrieveError() calls (qlWizard)
- removing any dynamic memory allocation in bond irr calculation
- null strike -> atm strike (1W|WIP)
- arrange sessions on Rapisarda approach(TBD)
D historic corr matrix (2D|2D)
D control panel . xls crash when switch to MxCurve
D Citrix access: $+,BGM
D Citrix access: INFL
- XML/ serialization presentation
D MM: different correlation structures (Rapisarda, Schoenmakers and
  Coffey)(5.5D/2D-5D) (To be reviewed)
- notification chains pb (1D/3D)
  tTermStructure lazyness in notification
- smile sections:
	- use Levenberg optimizator
	- move vol quotes from constructor(to be precised)
- add SABR interpolation to the capstripper(to be precised)
- OH Wizard performance issue when the control panel is left opened(to be
  precised)
- test abcd calibration (to be precised)
- TO BE REVIEWED MultiStepSwaption
- check sabr fit stability/accuracy for smilesections (.5D)
- review workbooks: SmileSectionCaps.xls, SimpleQuote.xls, DerivedQuotes.xls,
  CapStripperTest3M.xls. (to be precised)

---
GIORGIO (last update 6/6/2007)
WIP clean up vega incoherencies
WIP code MakeSwaption class
D split up CmsMarket and CmsMarketCalibration in 2 files
WIP use Handle in SwaptionVolCubeChecks
D abcd
D vega weighted abcd fit
D interpolation
- CMS
  alternative calibrations with null rho
  check 2Y beta sensitivity
- EvolutionDescription equality
D VBA missing menus:
  D enum QuantLib::EndCriteria::Type
  D enum QuantLib::CmsMarketCalibration::CalibrationType
  D class QuantLib::IborCouponPricer
  D class QuantLib::Payoff
  D class QuantLib::PricingEngine
  D class QuantLib::PiecewiseYieldCurve (Traits, Interpolation)
- prepare smile section refactoring proposal
- range accrual session
- CDS options (with Chiara)
- illustrate projectedCostFunction to Ferdinando
- WIP ratchet Instrument C++ (shared with Marco) (3d/7d)
- WIP range accrual coupon (con relativi test) (18d/30d)
  - WIP create a workbook for range accrual under
    Workbooks\InterestRateDerivatives designing the workbook as done for
      CMS.xls
- Visual Studio Express installation

---
MARCO (last update 27/6/2007)
- Citrix showdown: (1d/1d/DONE)
  - verifica licenze accesso: individuato referente, -> Katiuscia (DONE)
  - verifica accesso a $+ (DONE)
  - utenze BGM x tutti (DONE)
  - autorizzazione accesso Francois a Iflazione (DONE)
  - assistenza verifica accesso Quants (waiting Ametrano)
- check optimizers:
  - fix steepest descent (with Francois) (1d/2d/WIP)
  - add more tests (multidimensional) in test suite (to be planned)
  - add Broyden-Fletcher-Goldfarb-Shanno algorithm (to be planned)
  - check export to excel and testing wkb (to be planned)
- historical correlation (shared with francois; TO BE REVIEWED)
- pricing plain vanilla legs in BGM book (with Marco/Giorgio/Cristina)
  (0.0/2d/WAITING FOR DIGITAL OPTIONS)
- Risk, Wilmott papers (0.0/1d/WAITING for Ferdinando)
- Inflation project:
  - Attività UAT (3w/2w/DONE)
  - Caboto/DOF platform release EOD (DONE)
  - Caboto/DOF platform release intraday (DONE)
  - Planning phase 2 (DONE)
  - implementation of binary, digital, range accrual payoffs (TEST)
  - implementation of Montecarlo pricing for TFR (TEST)
  - 3 factor model and Hybrids (WIP)
- Applix: Rolling bund Futures on 8/9/2007 (TBD)

---
Eric
- SA
- Reuters
- Trader wbk problem
- object creation

- DevCycle branches/tags
- nazcatech SVN browse?
- SA version number
- HD serial number
- mkt data imp/exp


- 2 DOF projects
- JRisk
- there is no warning if there is an empty xll list to be loaded by QuantLix.xla
- soohxll doesn't compile in debug mode
- bond currency propety value cast
- allow foo object to have method to create bar objects
- enforce implicit Property Names (e.g. objectID, className) first letter
  capitalization
- Sensitivity Analysis menu before Windows
- remove trigger ohretrieveError() calls
- setProperty
- rename all Index as InterestRateIndex (we haven't used Indexes yet, only
  InterestRateIndexes), the only index we are enumerating so far are
  InterestRateIndex
- ohRange coercion to Matrix, std::vector, Array, scalar, string, etc
- in index.xml use QuantLibAddin::Index::addFixings instead of
  QuantLib::Index::addFixings
- relinkable handle singletons
- native support of vector of object IDS (as RateHelpers in
  PiecewiseYieldCurve)
- automate xls properties clean up
- enumeration aliases: avoid all aliases in ohEnumeratedType("class
  QuantLib::DayCounter")
- automatic dropdown cell menu maintenance (see Enumerations.xls)
- native Excel looping behaviour
- HistoricalForwardRatesAnalysis should not calculate in wizard
- business252 designed as in JointCalendar
- market data serialization
- multicurrency analysis
- bloomberg dll loading
- compilation time (header inclusion clean up, multiple xll, ecc)
- QuantLibXL About should use qlXlVersion()
- when returning a singe col (row) matrix add another col (row)
  with #NA to prevent Excel from duplicating col (row)
- when returning a singe cell vector add another cell
  with #NA to prevent Excel from duplicating cel
- xml schema
- extra arguments in function goes unnoticed instead of throwing an error
- why xll loading does not receive the same graful failure treatment
- open log file from menu
- log defaults
- minimize Launcher data download
- coerce Frequency->Period, Period->Date->double/int
- coerce from IMMcode to date
- imm functions (dates.xml) problems
- remove quantlibxl-bin.nsi
- merge quantlibxl.nsi and quantlib-network.nsi
- in the nsi generalize the location of the xml files
- oh.chm
- automatic ohSplit usage to coerce from string to vector
- ohConcatenate, ohRange1D, ohRange2D
- command (remove function SetEvaluationDate, etc?)
- discount factors output is not col/row enabled
- esporre ad excel i metodi commentati in payoff.xml
- visitor pattern per 3rd parameter dei payoff
- Handle coercion to SwaptionVolDiscrete
- freeze, unfreeze objects

QuantLib
- pricing enine refactoring
- Cashflows::iborSpread function
- clean up index fixing calendar
- cash rebate è multistep?
- aggiungere Forward all'enumeration Call/Put
- fix convertible faceamount bug
- deprecate swaptionvol time interface
- corregere OneAssetOption impliedVol
- SWAP implement fair rate for floating/fixed rate vector
- use boost random number generators
- Volatility assume a daycounter in the same way as rate (see InterestRate)
- ForwardSpreadedCurve con spread term structure
- throw first what in notifyobservers
- Instrument<Args>
- Inherit Exercise from Event?
- use strategy pattern for simulation termination criteria
- se possibile rispettare la misura ProductSuggested nel Composite

QuantLib RATEHELPERS
- earliest days dovrebbe tener conto dei fixing days

QuantLib PIECEWISEYIELDCURVE
- FRARateHelper deve avere dentro in FRA Instrument
- turn of year
- extended grid with all relevant dates
- revise bondhelpers
- bootstrap ForwardSpreadedYieldCurve

LUIGI
- debug vari crash in test suite per floating point exception
- risolvere Halley improvements
- InterpolatedYieldTermStructure<Discount,LogLinear>
- InterpolatedYieldTermStructure<Discount,LogLinear> constructor using an input
  discount grid
- InterpolatedYieldTermStructure<Discount,LogLinear>::gridDates()
- generic ForwardSpreadedYieldCurve (spread term structure)
- bootstrap ForwardSpreadedYieldCurve using its own ratehelpers and a base
  curve

QUANTLIBADDIN
- RSG factory
- export ImpliedCurve
- export PathGeneration
- export discount, loglinear selection
- use QL folder structure
- port old QuantLibXL functionalities

QUANTLIBXL WORKBOOKS
- nel ControlPanel dare evidenza dei feed: CMS
- Property example?
- SWAPTION spreadsheet with multiple prices
- all spreadsheets with grid prices
- merge old QuantLibXL functions
- more calendar drop down cell menu
- YYYYDDMM_HHMM timestamp in log file name doesn't work the second time
- file name cannot be changed without time

QUANTLIBXL VBA
